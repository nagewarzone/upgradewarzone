<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <title>NAGE WARZONE  CRAFT/UPGRADE ITEMS</title>
  <style>
    body { font-family: sans-serif; background: #f4f4f4; padding: 20px; }
    .tabs { display: flex; gap: 10px; margin-bottom: 20px; }
    .tabs button { padding: 10px 20px; cursor: pointer; border: none; border-radius: 5px; background: #ddd; }
    .tabs button.active { background: #007BFF; color: white; }
    .tab-content { display: none; }
    .tab-content.active { display: block; }
    input, button[type="submit"] { padding: 10px; width: 100%; margin-bottom: 10px; }
    button[type="submit"] { background: #007BFF; color: white; border: none; cursor: pointer; }
    p { white-space: pre-line; }
    #logoutBtn {
      position: absolute;
      top: 20px;
      right: 20px;
      padding: 8px 12px;
      background: #dc3545;
      color: white;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      display: none;
    }
  </style>
</head>
<body>

<h2>NANAGE WZRZONE  CRAFT/UPGRADE ITEMS</h2>

<div class="tabs">
  <button id="btnRegister">‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å</button>
  <button id="btnLogin" class="active">‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö</button>
  <button id="btnUpgrade" style="display:none;">‡∏≠‡∏±‡∏û‡πÄ‡∏Å‡∏£‡∏î‡πÑ‡∏≠‡πÄ‡∏ó‡πá‡∏°</button>
</div>

<!-- ‡∏õ‡∏∏‡πà‡∏° Logout -->
<button id="logoutBtn">‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö</button>

<!-- ‡πÅ‡∏™‡∏î‡∏á Token, TOPGM, Warzone -->
<div id="userStats" style="display:none; margin-bottom: 15px;">
  <strong>PEMTO:</strong> <span id="tokenCount">-</span> |
  <strong>‡∏õ‡∏•‡∏≠‡∏Å TOPGM:</strong> <span id="topgmCount">-</span> |
  <strong>‡πÇ‡∏•‡πà Warzone:</strong> <span id="warzoneCount">-</span> |
  <strong>POINT:</strong> <span id="POINT">-</span>
  <button id="btnAddTopgm" style="margin-left:10px; padding:3px 8px; font-size:14px; cursor:pointer;">+1 TOPGM (50 POINT)</button>
</div>

<div id="register" class="tab-content">
  <form id="registerForm">
    <input type="text" id="regUsername" placeholder="Username" required autocomplete="username" />
    <input type="password" id="regPassword" placeholder="Password" required autocomplete="new-password" />
    <input type="password" id="regConfirmPassword" placeholder="‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô" required autocomplete="new-password" />
    <button type="submit">‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å</button>
    <p id="registerResult"></p>
  </form>
</div>

<div id="login" class="tab-content active">
  <form id="loginForm">
    <input type="text" id="loginUsername" placeholder="Username" required autocomplete="username" />
    <input type="password" id="loginPassword" placeholder="Password" required autocomplete="current-password" />
    <button type="submit">‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö</button>
    <p id="loginResult"></p>
  </form>
</div>

<div id="upgrade" class="tab-content">
  <form id="upgradeForm">
    <input type="text" id="upgradeName" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏ï‡∏±‡∏ß‡∏•‡∏∞‡∏Ñ‡∏£" required autocomplete="off" />
    <button type="submit">‡∏≠‡∏±‡∏û‡πÄ‡∏Å‡∏£‡∏î‡πÑ‡∏≠‡πÄ‡∏ó‡πá‡∏°</button>
    <p id="upgradeResult"></p>
  </form>
</div>

<script>
  const apiURL = 'https://upgradewarzone.onrender.com';
  let loggedInUser = null;
  let loggedInPass = null;

  // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏ó‡πá‡∏ö
  function switchTab(tabName) {
    document.querySelectorAll('.tab-content').forEach(t => t.classList.remove('active'));
    document.getElementById(tabName).classList.add('active');

    document.querySelectorAll('.tabs button').forEach(b => b.classList.remove('active'));
    document.getElementById('btnRegister').classList.remove('active');
    document.getElementById('btnLogin').classList.remove('active');
    document.getElementById('btnUpgrade').classList.remove('active');

    if (tabName === 'register') document.getElementById('btnRegister').classList.add('active');
    else if (tabName === 'login') document.getElementById('btnLogin').classList.add('active');
    else if (tabName === 'upgrade') document.getElementById('btnUpgrade').classList.add('active');
  }

  document.getElementById('btnRegister').onclick = () => switchTab('register');
  document.getElementById('btnLogin').onclick = () => switchTab('login');
  document.getElementById('btnUpgrade').onclick = () => switchTab('upgrade');

  document.getElementById('logoutBtn').onclick = () => {
    localStorage.removeItem('username');
    localStorage.removeItem('password');
    loggedInUser = null;
    loggedInPass = null;
    document.getElementById('userStats').style.display = 'none';
    document.getElementById('btnUpgrade').style.display = 'none';
    document.getElementById('logoutBtn').style.display = 'none';
    switchTab('login');
  };

  async function loadUserStats() {
    const res = await fetch(apiURL, {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ action: 'userinfo', username: loggedInUser, password: loggedInPass })
    });
    const data = await res.json();
    if (data.success) {
      document.getElementById('tokenCount').textContent = data.token;
      document.getElementById('topgmCount').textContent = data.topgm;
      document.getElementById('warzoneCount').textContent = data.warzone;
      document.getElementById('POINT').textContent = data.point || 0;
      document.getElementById('userStats').style.display = 'block';
    }
  }

  // ‡πÇ‡∏´‡∏•‡∏î‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏à‡∏≤‡∏Å localStorage ‡∏ñ‡πâ‡∏≤‡∏°‡∏µ
  window.addEventListener('DOMContentLoaded', async () => {
    const user = localStorage.getItem('username');
    const pass = localStorage.getItem('password');
    if (user && pass) {
      loggedInUser = user;
      loggedInPass = pass;
      document.getElementById('btnUpgrade').style.display = 'inline-block';
      document.getElementById('logoutBtn').style.display = 'inline-block';
      switchTab('upgrade');
      await loadUserStats();
    }
  });

  // ‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¥‡∏ô
  document.getElementById('loginForm').onsubmit = async e => {
    e.preventDefault();
    const username = document.getElementById('loginUsername').value.trim();
    const password = document.getElementById('loginPassword').value;
    const resultP = document.getElementById('loginResult');

    const res = await fetch(apiURL, {
      method: 'POST',
      headers: {'Content-Type': 'application/json'},
      body: JSON.stringify({ action: 'login', username, password })
    });
    const data = await res.json();

    if (data.success) {
      loggedInUser = username;
      loggedInPass = password;
      localStorage.setItem('username', username);
      localStorage.setItem('password', password);
      resultP.style.color = 'green';
      resultP.textContent = '‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!';
      document.getElementById('btnUpgrade').style.display = 'inline-block';
      document.getElementById('logoutBtn').style.display = 'inline-block';
      switchTab('upgrade');
      await loadUserStats();
    } else {
      resultP.style.color = 'red';
      resultP.textContent = data.message || '‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏´‡∏£‡∏∑‡∏≠‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á';
    }
  };

  // ‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å (‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á)
  document.getElementById('upgradeForm').onsubmit = async e => {
  e.preventDefault();
  
  // ‡∏•‡∏ö‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡πÄ‡∏î‡∏¥‡∏°‡∏ñ‡πâ‡∏≤‡∏°‡∏µ
  const oldNotify = document.getElementById('upgradeNotification');
  if (oldNotify) oldNotify.remove();

  const name = document.getElementById('upgradeName').value.trim();
  const resultP = document.getElementById('upgradeResult');
  const upgradeButton = document.querySelector('#upgradeForm button[type="submit"]');
  const originalButtonText = upgradeButton.textContent;

  // ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏õ‡∏∏‡πà‡∏°‡πÅ‡∏•‡∏∞‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°
  upgradeButton.textContent = '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏£‡∏ß‡∏°‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå...';
  upgradeButton.disabled = true;
 resultP.innerHTML = `
  <div style="text-align: center;">
    <img src="https://img2.pic.in.th/pic/image_2025-05-21_180926572.png" 
         alt="‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏≠‡∏±‡∏õ‡πÄ‡∏Å‡∏£‡∏î" 
         style="width: 400px; margin-top: 10px;">
  </div>
`;


  // ‡∏£‡∏≠ 3 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ
  await new Promise(resolve => setTimeout(resolve, 3000));

  // ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å API
  const res = await fetch(apiURL, {
    method: 'POST',
    headers: {'Content-Type': 'application/json'},
    body: JSON.stringify({ action: 'upgrade', username: loggedInUser, password: loggedInPass, name })
  });

  const data = await res.json();

  if (data.success) {
  let color, message, imageURL;

  switch(data.result) {
    case "‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à":
      color = 'darkgreen';
      message = '‡∏≠‡∏±‡∏õ‡πÄ‡∏Å‡∏£‡∏î‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à! üéâ ‡∏Ñ‡∏∏‡∏ì‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡πÑ‡∏≠‡πÄ‡∏ó‡πá‡∏°‡πÉ‡∏´‡∏°‡πà‡πÅ‡∏•‡πâ‡∏ß';
      imageURL = 'https://img2.pic.in.th/pic/Screenshot-2025-05-21-023115.png';
      break;
    case "‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß":
      color = '#cc6600';
      message = '‡∏≠‡∏±‡∏õ‡πÄ‡∏Å‡∏£‡∏î‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß! ‡∏Ç‡∏≠‡πÉ‡∏´‡πâ‡πÇ‡∏ä‡∏Ñ‡∏î‡∏µ‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏´‡∏ô‡πâ‡∏≤';
      imageURL = 'https://img5.pic.in.th/file/secure-sv1/18a5fd9683439dec252c4ed8898ad9c4.png';
      break;
    case "‡πÅ‡∏ï‡∏Å":
      color = 'red';
      message = '‡πÑ‡∏≠‡πÄ‡∏ó‡πá‡∏°‡∏ñ‡∏π‡∏Å‡∏ó‡∏≥‡∏•‡∏≤‡∏¢ !!';
      imageURL = 'https://img2.pic.in.th/pic/Screenshot-2025-05-21-023244.png';
      break;
    default:
      color = 'blue';
      message = data.result;
      imageURL = '';
  }

  const resultP = document.getElementById('upgradeResult');
  resultP.style.color = color;
  resultP.style.textAlign = 'center';

  // ‡∏ã‡πà‡∏≠‡∏ô‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° - ‡πÅ‡∏™‡∏î‡∏á‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏£‡∏π‡∏õ
  resultP.innerHTML = imageURL 
    ? `<img src="${imageURL}" alt="${data.result}" style="width: 400px; margin-top: 10px;">`
    : '';

  showUpgradeNotification(message, color);
  await loadUserStats();
}

   else {
    resultP.style.color = 'red';
    resultP.style.textAlign = 'left';
    resultP.textContent = data.message || '‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏≠‡∏±‡∏õ‡πÄ‡∏Å‡∏£‡∏î';
  }

  // ‡∏Ñ‡∏∑‡∏ô‡∏Ñ‡πà‡∏≤‡∏õ‡∏∏‡πà‡∏°‡πÄ‡∏î‡∏¥‡∏°
  upgradeButton.textContent = originalButtonText;
  upgradeButton.disabled = false;
};



// ‡πÅ‡∏Å‡πâ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡πÉ‡∏´‡πâ‡∏£‡∏±‡∏ö‡∏™‡∏µ‡∏î‡πâ‡∏ß‡∏¢
function showUpgradeNotification(message, color = '#155724') {
  let notifyDiv = document.getElementById('upgradeNotification');
  const resultP = document.getElementById('upgradeResult');
  
  if (!notifyDiv) {
    notifyDiv = document.createElement('div');
    notifyDiv.id = 'upgradeNotification';
    notifyDiv.style.padding = '15px 25px';
    notifyDiv.style.borderRadius = '10px';
    notifyDiv.style.boxShadow = '0 2px 10px rgba(0,0,0,0.2)';
    notifyDiv.style.zIndex = '1000';
    notifyDiv.style.textAlign = 'center';
    notifyDiv.style.maxWidth = '320px';
    notifyDiv.style.whiteSpace = 'normal';
    notifyDiv.style.wordWrap = 'break-word';
    notifyDiv.style.margin = '10px auto 0 auto';  // ‡πÄ‡∏ß‡πâ‡∏ô‡∏£‡∏∞‡∏¢‡∏∞‡∏ö‡∏ô ‡πÅ‡∏•‡∏∞‡∏Å‡∏•‡∏≤‡∏á‡∏à‡∏≠‡πÅ‡∏ô‡∏ß‡∏ô‡∏≠‡∏ô
    // ‡πÅ‡∏ó‡∏£‡∏Å‡πÑ‡∏ß‡πâ‡πÉ‡∏ï‡πâ resultP
    resultP.parentNode.insertBefore(notifyDiv, resultP.nextSibling);
  }

  notifyDiv.innerHTML = '';

  if (color === 'darkgreen') {
    const img = document.createElement('img');
    img.src = 'https://img5.pic.in.th/file/secure-sv1/image_2025-05-21_025140493-removebg-preview.png';
    img.alt = '‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à';
    img.style.width = '200px';
    img.style.height = '200px';
    img.style.display = 'block';
    img.style.margin = '0 auto 10px auto';
    notifyDiv.appendChild(img);
  }

  const textNode = document.createElement('div');
  textNode.textContent = message;
  notifyDiv.appendChild(textNode);

  if (color === 'darkgreen') {
    notifyDiv.style.backgroundColor = '#d4edda';
    notifyDiv.style.color = '#155724';
    notifyDiv.style.border = '1px solid #c3e6cb';
  } else if (color === '#cc6600') {
    notifyDiv.style.backgroundColor = '#ffdb99';
    notifyDiv.style.color = '#b35900';
    notifyDiv.style.border = '1px solid #d18c1a';
  } else if (color === 'red') {
    notifyDiv.style.backgroundColor = '#f8d7da';
    notifyDiv.style.color = '#721c24';
    notifyDiv.style.border = '1px solid #f5c6cb';
  } else if (color === 'blue') {
    notifyDiv.style.backgroundColor = '#cce5ff';
    notifyDiv.style.color = '#004085';
    notifyDiv.style.border = '1px solid #b8daff';
  } else {
    notifyDiv.style.backgroundColor = '#d4edda';
    notifyDiv.style.color = '#155724';
    notifyDiv.style.border = '1px solid #c3e6cb';
  }

  setTimeout(() => {
    if (notifyDiv) notifyDiv.remove();
  }, 10000);
}



  // ‡∏õ‡∏∏‡πà‡∏°‡πÄ‡∏û‡∏¥‡πà‡∏° TOPGM (‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á)
  document.getElementById('btnAddTopgm').onclick = async () => {
  const name = document.getElementById('upgradeName').value.trim();
  if (!name) {
    alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡∏ï‡∏±‡∏ß‡∏•‡∏∞‡∏Ñ‡∏£‡∏Å‡πà‡∏≠‡∏ô');
    return;
  }

  if (!confirm('‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ POINT 50 ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏û‡∏¥‡πà‡∏° TOPGM +1 ‡πÉ‡∏ä‡πà‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?')) return;

  const res = await fetch(apiURL, {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({
      action: 'usepoint',
      username: loggedInUser,
      password: loggedInPass,
      name, // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ
      pointChange: -50,
      topgmChange: 1
    })
  });

  const data = await res.json();
  if (data.success) {
    alert('‡πÄ‡∏û‡∏¥‡πà‡∏° TOPGM +1 ‡πÅ‡∏•‡∏∞‡∏´‡∏±‡∏Å POINT 50 ‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß');
    await loadUserStats();
  } else {
    alert('‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏û‡∏¥‡πà‡∏° TOPGM ‡πÑ‡∏î‡πâ: ' + (data.message || 'POINT ‡∏≠‡∏≤‡∏à‡πÑ‡∏°‡πà‡πÄ‡∏û‡∏µ‡∏¢‡∏á‡∏û‡∏≠'));
  }
};

</script>
</body>
</html>
